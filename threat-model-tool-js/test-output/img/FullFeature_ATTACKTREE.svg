<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="2277pt" height="848pt"
 viewBox="0.00 0.00 2277.18 848.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 844)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-844 2273.18,-844 2273.18,4 -4,4"/>
<!-- FullFeature -->
<g id="node1" class="node">
<title>FullFeature</title>
<ellipse fill="#bae9ff" stroke="#b85450" cx="188.09" cy="-189" rx="188.18" ry="25.41"/>
<text text-anchor="start" x="65.09" y="-192.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="84.09" y="-192.4" font-family="Arial" font-weight="bold" font-size="12.00">Comprehensive Reference Threat</text>
<text text-anchor="start" x="152.09" y="-180.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="171.09" y="-180.4" font-family="Arial" font-weight="bold" font-size="12.00">Model</text>
<text text-anchor="start" x="212.09" y="-180.4" font-family="Arial" font-size="12.00"> &#160;&#160;</text>
</g>
<!-- THREAT_SQL_INJECTION -->
<g id="node2" class="node">
<title>THREAT_SQL_INJECTION</title>
<g id="a_node2"><a xlink:href="../index.html#THREAT_SQL_INJECTION" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1148.68,-362 602.68,-362 602.68,-320 1148.68,-320 1148.68,-362"/>
<text text-anchor="start" x="612.68" y="-347.4" font-family="Arial" font-weight="bold" font-size="12.00">SQL Injection </text>
<text text-anchor="start" x="706.68" y="-347.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="776.68" y="-347.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#cc0500" stroke="transparent" points="822.68,-341 822.68,-358 925.68,-358 925.68,-341 822.68,-341"/>
<text text-anchor="start" x="837.68" y="-346.4" font-family="Arial" font-size="12.00">9.8 (Critical)</text>
<text text-anchor="start" x="612.68" y="-329.4" font-family="Arial" font-size="12.00">1. Find vulnerable input field. 2. Inject SQL payload. </text>
</a>
</g>
</g>
<!-- THREAT_SQL_INJECTION&#45;&gt;FullFeature -->
<g id="edge2" class="edge">
<title>THREAT_SQL_INJECTION&#45;&gt;FullFeature</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M602.53,-321.53C558.95,-315.64 514.58,-307.98 473.18,-298 393.64,-278.83 306.36,-242.96 249.82,-217.61"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="251.22,-214.41 240.67,-213.48 248.34,-220.79 251.22,-214.41"/>
<text text-anchor="middle" x="424.68" y="-294.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- THREAT_SQL_INJECTION_countermeasure0 -->
<g id="node3" class="node">
<title>THREAT_SQL_INJECTION_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-378 1555.18,-378 1555.18,-330 2101.18,-330 2101.18,-378"/>
<text text-anchor="start" x="1630.68" y="-363.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1661.68" y="-363.4" font-family="Arial" font-weight="bold" font-size="12.00">Use Prepared Statements</text>
<text text-anchor="start" x="1565.18" y="-339.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Ensure all DB queries use parameterized inputs. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- THREAT_SQL_INJECTION_countermeasure0&#45;&gt;THREAT_SQL_INJECTION -->
<g id="edge1" class="edge">
<title>THREAT_SQL_INJECTION_countermeasure0&#45;&gt;THREAT_SQL_INJECTION</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-350.28C1431.07,-348.58 1284.26,-346.57 1158.99,-344.86"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.91,-341.36 1148.86,-344.72 1158.81,-348.36 1158.91,-341.36"/>
<text text-anchor="middle" x="1332.68" y="-350.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- THREAT_DATA_LEAK -->
<g id="node4" class="node">
<title>THREAT_DATA_LEAK</title>
<g id="a_node4"><a xlink:href="../index.html#THREAT_DATA_LEAK" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#f8cecc" stroke="#e06666" stroke-width="2" points="1148.68,-289 602.68,-289 602.68,-247 1148.68,-247 1148.68,-289"/>
<text text-anchor="start" x="612.68" y="-274.4" font-family="Arial" font-weight="bold" font-size="12.00">Potential Data Leak </text>
<text text-anchor="start" x="752.68" y="-274.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Vulnerable</text>
<text text-anchor="start" x="828.68" y="-274.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#f9a009" stroke="transparent" points="849.68,-268 849.68,-285 933.68,-285 933.68,-268 849.68,-268"/>
<text text-anchor="start" x="851.68" y="-273.4" font-family="Arial" font-size="12.00">6.5 (Medium)</text>
<text text-anchor="start" x="626.68" y="-256.4" font-family="Arial" font-size="12.00">Data might leak through logs or error messages.</text>
</a>
</g>
</g>
<!-- THREAT_DATA_LEAK&#45;&gt;FullFeature -->
<g id="edge4" class="edge">
<title>THREAT_DATA_LEAK&#45;&gt;FullFeature</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M692.31,-246.99C582.99,-234.39 445.57,-218.55 341.97,-206.62"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="342.07,-203.1 331.73,-205.44 341.27,-210.06 342.07,-203.1"/>
<text text-anchor="middle" x="424.68" y="-223.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- THREAT_DATA_LEAK_countermeasure0 -->
<g id="node5" class="node">
<title>THREAT_DATA_LEAK_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" stroke-width="2" points="2101.18,-312 1555.18,-312 1555.18,-264 2101.18,-264 2101.18,-312"/>
<text text-anchor="start" x="1581.18" y="-297.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1612.18" y="-297.4" font-family="Arial" font-weight="bold" font-size="12.00">Log Masking</text>
<text text-anchor="start" x="1565.18" y="-273.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Mask PII in logs. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- THREAT_DATA_LEAK_countermeasure0&#45;&gt;THREAT_DATA_LEAK -->
<g id="edge3" class="edge">
<title>THREAT_DATA_LEAK_countermeasure0&#45;&gt;THREAT_DATA_LEAK</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-282.28C1431.07,-279.67 1284.26,-276.58 1158.99,-273.94"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.93,-270.44 1148.86,-273.73 1158.78,-277.44 1158.93,-270.44"/>
<text text-anchor="middle" x="1332.68" y="-281.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- THREAT_KEY_COMPROMISE -->
<g id="node6" class="node">
<title>THREAT_KEY_COMPROMISE</title>
<g id="a_node6"><a xlink:href="../index.html#THREAT_KEY_COMPROMISE" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1244.68,-210 506.68,-210 506.68,-168 1244.68,-168 1244.68,-210"/>
<text text-anchor="start" x="516.68" y="-195.4" font-family="Arial" font-weight="bold" font-size="12.00">API Key Compromise </text>
<text text-anchor="start" x="662.68" y="-195.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="732.68" y="-195.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#cc0500" stroke="transparent" points="952.68,-189 952.68,-206 1236.68,-206 1236.68,-189 952.68,-189"/>
<text text-anchor="start" x="1054.18" y="-194.4" font-family="Arial" font-size="12.00">10.0 (Critical)</text>
<text text-anchor="start" x="516.68" y="-177.4" font-family="Arial" font-size="12.00">Attacker obtains API key through: 1. Source code repository exposure 2. Man&#45;in&#45;the&#45;middle attack 3. Social engineering </text>
</a>
</g>
</g>
<!-- THREAT_KEY_COMPROMISE&#45;&gt;FullFeature -->
<g id="edge7" class="edge">
<title>THREAT_KEY_COMPROMISE&#45;&gt;FullFeature</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M506.55,-189C465.16,-189 424.28,-189 386.31,-189"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="386.21,-185.5 376.21,-189 386.21,-192.5 386.21,-185.5"/>
<text text-anchor="middle" x="424.68" y="-192.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- THREAT_KEY_COMPROMISE_countermeasure0 -->
<g id="node7" class="node">
<title>THREAT_KEY_COMPROMISE_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2269.18,-246 1387.18,-246 1387.18,-198 2269.18,-198 2269.18,-246"/>
<text text-anchor="start" x="1740.68" y="-231.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1771.68" y="-231.4" font-family="Arial" font-weight="bold" font-size="12.00">Regular Key Rotation</text>
<text text-anchor="start" x="1397.18" y="-207.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Rotate API keys every 30 days or immediately upon suspected compromise. Keys should be stored in a secure vault with audit logging. &#160;&#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- THREAT_KEY_COMPROMISE_countermeasure0&#45;&gt;THREAT_KEY_COMPROMISE -->
<g id="edge5" class="edge">
<title>THREAT_KEY_COMPROMISE_countermeasure0&#45;&gt;THREAT_KEY_COMPROMISE</title>
<path fill="none" stroke="green" stroke-width="2" d="M1387.06,-206.72C1342.89,-205.19 1298.31,-203.64 1254.87,-202.13"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1254.85,-198.63 1244.74,-201.78 1254.61,-205.62 1254.85,-198.63"/>
<text text-anchor="middle" x="1332.68" y="-209.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- THREAT_KEY_COMPROMISE_countermeasure1 -->
<g id="node8" class="node">
<title>THREAT_KEY_COMPROMISE_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-180 1555.18,-180 1555.18,-132 2101.18,-132 2101.18,-180"/>
<text text-anchor="start" x="1653.18" y="-165.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1684.18" y="-165.4" font-family="Arial" font-weight="bold" font-size="12.00">Secure Key Storage</text>
<text text-anchor="start" x="1565.18" y="-141.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Store keys in HashiCorp Vault with audit logging. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- THREAT_KEY_COMPROMISE_countermeasure1&#45;&gt;THREAT_KEY_COMPROMISE -->
<g id="edge6" class="edge">
<title>THREAT_KEY_COMPROMISE_countermeasure1&#45;&gt;THREAT_KEY_COMPROMISE</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-165.45C1461.68,-168.69 1355.32,-172.38 1254.99,-175.87"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1254.86,-172.37 1244.99,-176.21 1255.1,-179.36 1254.86,-172.37"/>
<text text-anchor="middle" x="1332.68" y="-177.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- THREAT_RCE -->
<g id="node9" class="node">
<title>THREAT_RCE</title>
<g id="a_node9"><a xlink:href="../index.html#THREAT_RCE" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#f8cecc" stroke="#e06666" stroke-width="2" points="1148.68,-139 602.68,-139 602.68,-97 1148.68,-97 1148.68,-139"/>
<text text-anchor="start" x="612.68" y="-124.4" font-family="Arial" font-weight="bold" font-size="12.00">Remote Code Execution </text>
<text text-anchor="start" x="778.68" y="-124.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Vulnerable</text>
<text text-anchor="start" x="854.68" y="-124.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#cc0500" stroke="transparent" points="896.68,-118 896.68,-135 1003.68,-135 1003.68,-118 896.68,-118"/>
<text text-anchor="start" x="909.68" y="-123.4" font-family="Arial" font-size="12.00">10.0 (Critical)</text>
<text text-anchor="start" x="612.68" y="-106.4" font-family="Arial" font-size="12.00">Exploiting deserialization vulnerability to execute arbitrary code. </text>
</a>
</g>
</g>
<!-- THREAT_RCE&#45;&gt;FullFeature -->
<g id="edge9" class="edge">
<title>THREAT_RCE&#45;&gt;FullFeature</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M667.57,-139.01C605.1,-145.39 536.34,-152.44 473.18,-159 432.17,-163.26 387.83,-167.92 346.65,-172.26"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="346.11,-168.8 336.53,-173.33 346.84,-175.76 346.11,-168.8"/>
<text text-anchor="middle" x="424.68" y="-171.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- THREAT_RCE_countermeasure0 -->
<g id="node10" class="node">
<title>THREAT_RCE_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" stroke-width="2" points="2101.18,-114 1555.18,-114 1555.18,-66 2101.18,-66 2101.18,-114"/>
<text text-anchor="start" x="1627.68" y="-99.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1658.68" y="-99.4" font-family="Arial" font-weight="bold" font-size="12.00">Strict Input Validation</text>
<text text-anchor="start" x="1565.18" y="-75.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Validate and sanitize all deserialized input. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- THREAT_RCE_countermeasure0&#45;&gt;THREAT_RCE -->
<g id="edge8" class="edge">
<title>THREAT_RCE_countermeasure0&#45;&gt;THREAT_RCE</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-98.01C1431.07,-101.67 1284.26,-105.99 1158.99,-109.68"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.75,-106.19 1148.86,-109.98 1158.96,-113.19 1158.75,-106.19"/>
<text text-anchor="middle" x="1332.68" y="-108.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- THREAT_INFO_DISCLOSURE -->
<g id="node11" class="node">
<title>THREAT_INFO_DISCLOSURE</title>
<g id="a_node11"><a xlink:href="../index.html#THREAT_INFO_DISCLOSURE" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1148.68,-57 602.68,-57 602.68,-15 1148.68,-15 1148.68,-57"/>
<text text-anchor="start" x="612.68" y="-42.4" font-family="Arial" font-weight="bold" font-size="12.00">Minor Information Disclosure </text>
<text text-anchor="start" x="814.68" y="-42.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="884.68" y="-42.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#f9a009" stroke="transparent" points="905.68,-36 905.68,-53 989.68,-53 989.68,-36 905.68,-36"/>
<text text-anchor="start" x="907.68" y="-41.4" font-family="Arial" font-size="12.00">5.3 (Medium)</text>
<text text-anchor="start" x="661.68" y="-24.4" font-family="Arial" font-size="12.00">Version information exposed in HTTP headers.</text>
</a>
</g>
</g>
<!-- THREAT_INFO_DISCLOSURE&#45;&gt;FullFeature -->
<g id="edge11" class="edge">
<title>THREAT_INFO_DISCLOSURE&#45;&gt;FullFeature</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M646.47,-57.01C589.44,-64.59 528.72,-74.69 473.18,-88 396.79,-106.31 312.34,-137.86 255.52,-160.83"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="253.89,-157.72 245.95,-164.73 256.53,-164.2 253.89,-157.72"/>
<text text-anchor="middle" x="424.68" y="-111.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- THREAT_INFO_DISCLOSURE_countermeasure0 -->
<g id="node12" class="node">
<title>THREAT_INFO_DISCLOSURE_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-48 1555.18,-48 1555.18,0 2101.18,0 2101.18,-48"/>
<text text-anchor="start" x="1645.18" y="-33.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1676.18" y="-33.4" font-family="Arial" font-weight="bold" font-size="12.00">Remove Version Headers</text>
<text text-anchor="start" x="1565.18" y="-9.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Configure server to not expose version information. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- THREAT_INFO_DISCLOSURE_countermeasure0&#45;&gt;THREAT_INFO_DISCLOSURE -->
<g id="edge10" class="edge">
<title>THREAT_INFO_DISCLOSURE_countermeasure0&#45;&gt;THREAT_INFO_DISCLOSURE</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-27.43C1431.07,-29 1284.26,-30.85 1158.99,-32.44"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.81,-28.94 1148.86,-32.56 1158.9,-35.94 1158.81,-28.94"/>
<text text-anchor="middle" x="1332.68" y="-34.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- SubComponent -->
<g id="node13" class="node">
<title>SubComponent</title>
<ellipse fill="#bae9ff" stroke="#b85450" cx="188.09" cy="-515" rx="173.94" ry="18"/>
<text text-anchor="start" x="73.09" y="-512.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="92.09" y="-512.4" font-family="Arial" font-weight="bold" font-size="12.00">Sub&#45;Component Feature Test</text>
<text text-anchor="start" x="291.09" y="-512.4" font-family="Arial" font-size="12.00"> &#160;&#160;</text>
</g>
<!-- SUB_THREAT_DOS -->
<g id="node14" class="node">
<title>SUB_THREAT_DOS</title>
<g id="a_node14"><a xlink:href="../index.html#SUB_THREAT_DOS" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1202.68,-570 548.68,-570 548.68,-528 1202.68,-528 1202.68,-570"/>
<text text-anchor="start" x="558.68" y="-555.4" font-family="Arial" font-weight="bold" font-size="12.00">Denial of Service on Sub Component </text>
<text text-anchor="start" x="810.68" y="-555.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="880.68" y="-555.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#df3d03" stroke="transparent" points="1016.68,-549 1016.68,-566 1194.68,-566 1194.68,-549 1016.68,-549"/>
<text text-anchor="start" x="1076.18" y="-554.4" font-family="Arial" font-size="12.00">7.5 (High)</text>
<text text-anchor="start" x="558.68" y="-537.4" font-family="Arial" font-size="12.00">Overwhelming the sub&#45;component with excessive requests, causing service degradation or unavailability. </text>
</a>
</g>
</g>
<!-- SUB_THREAT_DOS&#45;&gt;SubComponent -->
<g id="edge13" class="edge">
<title>SUB_THREAT_DOS&#45;&gt;SubComponent</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M548.45,-532.82C481.39,-529.5 413.49,-526.13 355.03,-523.23"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="355.15,-519.73 344.99,-522.73 354.8,-526.72 355.15,-519.73"/>
<text text-anchor="middle" x="424.68" y="-530.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- SUB_THREAT_DOS_countermeasure0 -->
<g id="node15" class="node">
<title>SUB_THREAT_DOS_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-576 1555.18,-576 1555.18,-528 2101.18,-528 2101.18,-576"/>
<text text-anchor="start" x="1690.68" y="-561.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1721.68" y="-561.4" font-family="Arial" font-weight="bold" font-size="12.00">Rate Limiting</text>
<text text-anchor="start" x="1565.18" y="-537.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Limit requests to the sub component to 1000 req/sec. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- SUB_THREAT_DOS_countermeasure0&#45;&gt;SUB_THREAT_DOS -->
<g id="edge12" class="edge">
<title>SUB_THREAT_DOS_countermeasure0&#45;&gt;SUB_THREAT_DOS</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-551.14C1448.48,-550.8 1325.03,-550.42 1212.89,-550.06"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1212.78,-546.56 1202.77,-550.03 1212.76,-553.56 1212.78,-546.56"/>
<text text-anchor="middle" x="1332.68" y="-553.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- SUB_THREAT_KEY_LEAK -->
<g id="node16" class="node">
<title>SUB_THREAT_KEY_LEAK</title>
<g id="a_node16"><a xlink:href="../index.html#SUB_THREAT_KEY_LEAK" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1148.68,-507 602.68,-507 602.68,-465 1148.68,-465 1148.68,-507"/>
<text text-anchor="start" x="612.68" y="-492.4" font-family="Arial" font-weight="bold" font-size="12.00">Sub&#45;Component Key Exposure </text>
<text text-anchor="start" x="821.68" y="-492.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="891.68" y="-492.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#df3d03" stroke="transparent" points="919.68,-486 919.68,-503 990.68,-503 990.68,-486 919.68,-486"/>
<text text-anchor="start" x="925.68" y="-491.4" font-family="Arial" font-size="12.00">8.1 (High)</text>
<text text-anchor="start" x="612.68" y="-474.4" font-family="Arial" font-size="12.00">API key for sub&#45;component exposed through misconfiguration.</text>
</a>
</g>
</g>
<!-- SUB_THREAT_KEY_LEAK&#45;&gt;SubComponent -->
<g id="edge16" class="edge">
<title>SUB_THREAT_KEY_LEAK&#45;&gt;SubComponent</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M602.38,-491.85C534.36,-493.89 461.59,-496.55 394.18,-500 375.58,-500.95 356.05,-502.14 336.74,-503.42"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="336.4,-499.94 326.66,-504.1 336.88,-506.92 336.4,-499.94"/>
<text text-anchor="middle" x="424.68" y="-503.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- SUB_THREAT_KEY_LEAK_countermeasure0 -->
<g id="node17" class="node">
<title>SUB_THREAT_KEY_LEAK_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-510 1555.18,-510 1555.18,-462 2101.18,-462 2101.18,-510"/>
<text text-anchor="start" x="1690.68" y="-495.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1721.68" y="-495.4" font-family="Arial" font-weight="bold" font-size="12.00">Rate Limiting</text>
<text text-anchor="start" x="1565.18" y="-471.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Limit requests to the sub component to 1000 req/sec. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- SUB_THREAT_KEY_LEAK_countermeasure0&#45;&gt;SUB_THREAT_KEY_LEAK -->
<g id="edge14" class="edge">
<title>SUB_THREAT_KEY_LEAK_countermeasure0&#45;&gt;SUB_THREAT_KEY_LEAK</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-486C1431.07,-486 1284.26,-486 1158.99,-486"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.86,-482.5 1148.86,-486 1158.86,-489.5 1158.86,-482.5"/>
<text text-anchor="middle" x="1332.68" y="-489.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- SUB_THREAT_KEY_LEAK_countermeasure1 -->
<g id="node18" class="node">
<title>SUB_THREAT_KEY_LEAK_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-444 1555.18,-444 1555.18,-396 2101.18,-396 2101.18,-444"/>
<text text-anchor="start" x="1631.68" y="-429.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1662.68" y="-429.4" font-family="Arial" font-weight="bold" font-size="12.00">Key Access Auditing</text>
<text text-anchor="start" x="1565.18" y="-405.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Log and monitor all key access attempts. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- SUB_THREAT_KEY_LEAK_countermeasure1&#45;&gt;SUB_THREAT_KEY_LEAK -->
<g id="edge15" class="edge">
<title>SUB_THREAT_KEY_LEAK_countermeasure1&#45;&gt;SUB_THREAT_KEY_LEAK</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-438.89C1431.07,-447.5 1284.26,-457.7 1158.99,-466.4"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.59,-462.92 1148.86,-467.1 1159.08,-469.9 1158.59,-462.92"/>
<text text-anchor="middle" x="1332.68" y="-457.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- ApiGateway -->
<g id="node19" class="node">
<title>ApiGateway</title>
<ellipse fill="#bae9ff" stroke="#b85450" cx="188.09" cy="-717" rx="168.32" ry="18"/>
<text text-anchor="start" x="77.09" y="-714.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="96.09" y="-714.4" font-family="Arial" font-weight="bold" font-size="12.00">API Gateway Security Model</text>
<text text-anchor="start" x="287.09" y="-714.4" font-family="Arial" font-size="12.00"> &#160;&#160;</text>
</g>
<!-- GW_JWT_FORGERY -->
<g id="node20" class="node">
<title>GW_JWT_FORGERY</title>
<g id="a_node20"><a xlink:href="../index.html#GW_JWT_FORGERY" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1278.18,-771 473.18,-771 473.18,-729 1278.18,-729 1278.18,-771"/>
<text text-anchor="start" x="483.68" y="-756.4" font-family="Arial" font-weight="bold" font-size="12.00">JWT Token Forgery </text>
<text text-anchor="start" x="614.68" y="-756.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="684.68" y="-756.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#cc0500" stroke="transparent" points="949.68,-750 949.68,-767 1270.68,-767 1270.68,-750 949.68,-750"/>
<text text-anchor="start" x="1073.68" y="-755.4" font-family="Arial" font-size="12.00">9.1 (Critical)</text>
<text text-anchor="start" x="483.68" y="-738.4" font-family="Arial" font-size="12.00">Attacker forges JWT token by: 1. Exploiting weak algorithm (alg:none) 2. Brute&#45;forcing weak secret 3. Key confusion attack (RS/HS) </text>
</a>
</g>
</g>
<!-- GW_JWT_FORGERY&#45;&gt;ApiGateway -->
<g id="edge19" class="edge">
<title>GW_JWT_FORGERY&#45;&gt;ApiGateway</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M472.9,-730.66C430.55,-728.62 389.45,-726.64 352.28,-724.85"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="352.05,-721.34 341.9,-724.36 351.72,-728.33 352.05,-721.34"/>
<text text-anchor="middle" x="424.68" y="-732.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- GW_JWT_FORGERY_countermeasure0 -->
<g id="node21" class="node">
<title>GW_JWT_FORGERY_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-840 1555.18,-840 1555.18,-792 2101.18,-792 2101.18,-840"/>
<text text-anchor="start" x="1658.18" y="-825.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1689.18" y="-825.4" font-family="Arial" font-weight="bold" font-size="12.00">Algorithm Whitelist</text>
<text text-anchor="start" x="1565.18" y="-801.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Only allow RS256 algorithm, reject &#39;none&#39; and HS. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- GW_JWT_FORGERY_countermeasure0&#45;&gt;GW_JWT_FORGERY -->
<g id="edge17" class="edge">
<title>GW_JWT_FORGERY_countermeasure0&#45;&gt;GW_JWT_FORGERY</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-797.11C1441.05,-789.19 1307.72,-779.93 1189.61,-771.73"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1189.54,-768.22 1179.32,-771.01 1189.05,-775.2 1189.54,-768.22"/>
<text text-anchor="middle" x="1332.68" y="-786.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- GW_JWT_FORGERY_countermeasure1 -->
<g id="node22" class="node">
<title>GW_JWT_FORGERY_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-774 1555.18,-774 1555.18,-726 2101.18,-726 2101.18,-774"/>
<text text-anchor="start" x="1681.18" y="-759.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1712.18" y="-759.4" font-family="Arial" font-weight="bold" font-size="12.00">Strong JWT Secret</text>
<text text-anchor="start" x="1565.18" y="-735.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Use cryptographically strong random secret (256+ bits). &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- GW_JWT_FORGERY_countermeasure1&#45;&gt;GW_JWT_FORGERY -->
<g id="edge18" class="edge">
<title>GW_JWT_FORGERY_countermeasure1&#45;&gt;GW_JWT_FORGERY</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-750C1471.97,-750 1378.6,-750 1288.34,-750"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1288.2,-746.5 1278.2,-750 1288.2,-753.5 1288.2,-746.5"/>
<text text-anchor="middle" x="1332.68" y="-753.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- GW_RATE_LIMIT_BYPASS -->
<g id="node23" class="node">
<title>GW_RATE_LIMIT_BYPASS</title>
<g id="a_node23"><a xlink:href="../index.html#GW_RATE_LIMIT_BYPASS" xlink:title="&lt;TABLE&gt;" target="_top">
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="1148.68,-705 602.68,-705 602.68,-663 1148.68,-663 1148.68,-705"/>
<text text-anchor="start" x="612.68" y="-690.4" font-family="Arial" font-weight="bold" font-size="12.00">Rate Limit Bypass </text>
<text text-anchor="start" x="739.68" y="-690.4" font-family="Arial" font-weight="bold" font-style="italic" font-size="12.00">&#45;Mitigated</text>
<text text-anchor="start" x="809.68" y="-690.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;</text>
<polygon fill="#f9a009" stroke="transparent" points="902.68,-684 902.68,-701 1059.68,-701 1059.68,-684 902.68,-684"/>
<text text-anchor="start" x="941.18" y="-689.4" font-family="Arial" font-size="12.00">5.9 (Medium)</text>
<text text-anchor="start" x="612.68" y="-672.4" font-family="Arial" font-size="12.00">Bypassing rate limits through distributed requests or header manipulation.</text>
</a>
</g>
</g>
<!-- GW_RATE_LIMIT_BYPASS&#45;&gt;ApiGateway -->
<g id="edge22" class="edge">
<title>GW_RATE_LIMIT_BYPASS&#45;&gt;ApiGateway</title>
<path fill="none" stroke="#b85450" stroke-width="2" d="M602.24,-697.11C517.67,-701.18 427.12,-705.54 352.42,-709.14"/>
<polygon fill="#b85450" stroke="#b85450" stroke-width="2" points="351.8,-705.66 341.98,-709.64 352.14,-712.66 351.8,-705.66"/>
<text text-anchor="middle" x="424.68" y="-709.8" font-family="Times,serif" font-size="14.00">impacts </text>
</g>
<!-- GW_RATE_LIMIT_BYPASS_countermeasure0 -->
<g id="node24" class="node">
<title>GW_RATE_LIMIT_BYPASS_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-708 1555.18,-708 1555.18,-660 2101.18,-660 2101.18,-708"/>
<text text-anchor="start" x="1658.18" y="-693.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1689.18" y="-693.4" font-family="Arial" font-weight="bold" font-size="12.00">Algorithm Whitelist</text>
<text text-anchor="start" x="1565.18" y="-669.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Only allow RS256 algorithm, reject &#39;none&#39; and HS. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- GW_RATE_LIMIT_BYPASS_countermeasure0&#45;&gt;GW_RATE_LIMIT_BYPASS -->
<g id="edge20" class="edge">
<title>GW_RATE_LIMIT_BYPASS_countermeasure0&#45;&gt;GW_RATE_LIMIT_BYPASS</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-684C1431.07,-684 1284.26,-684 1158.99,-684"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.86,-680.5 1148.86,-684 1158.86,-687.5 1158.86,-680.5"/>
<text text-anchor="middle" x="1332.68" y="-687.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- GW_RATE_LIMIT_BYPASS_countermeasure1 -->
<g id="node25" class="node">
<title>GW_RATE_LIMIT_BYPASS_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" stroke-width="2" points="2101.18,-642 1555.18,-642 1555.18,-594 2101.18,-594 2101.18,-642"/>
<text text-anchor="start" x="1680.68" y="-627.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;</text>
<text text-anchor="start" x="1711.68" y="-627.4" font-family="Arial" font-weight="bold" font-size="12.00">Client IP Fingerprinting</text>
<text text-anchor="start" x="1565.18" y="-603.4" font-family="Arial" font-size="12.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;Use multiple headers and techniques to identify true client IP. &#160;&#160;&#160;&#160;&#160;</text>
</g>
<!-- GW_RATE_LIMIT_BYPASS_countermeasure1&#45;&gt;GW_RATE_LIMIT_BYPASS -->
<g id="edge21" class="edge">
<title>GW_RATE_LIMIT_BYPASS_countermeasure1&#45;&gt;GW_RATE_LIMIT_BYPASS</title>
<path fill="none" stroke="green" stroke-width="2" d="M1555.12,-636.89C1431.07,-645.5 1284.26,-655.7 1158.99,-664.4"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1158.59,-660.92 1148.86,-665.1 1159.08,-667.9 1158.59,-660.92"/>
<text text-anchor="middle" x="1332.68" y="-655.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
</g>
</svg>
